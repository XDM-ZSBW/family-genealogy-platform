<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gladys Folder - Code Dependencies Analysis - Gladys Klingenberg's Life Story Wiki</title>
    <style>
        /* Reset and base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
        }
        
        /* Header */
        .header {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 1rem 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .header h1 {
            font-size: 1.8rem;
            font-weight: 300;
        }
        
        .nav-buttons {
            display: flex;
            gap: 1rem;
        }
        
        .nav-button {
            background: rgba(255,255,255,0.2);
            color: white;
            padding: 0.5rem 1rem;
            text-decoration: none;
            border-radius: 4px;
            transition: background 0.3s;
            border: 1px solid rgba(255,255,255,0.3);
        }
        
        .nav-button:hover {
            background: rgba(255,255,255,0.3);
            color: white;
        }
        
        /* Main container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 2rem;
        }
        
        /* Sidebar */
        .sidebar {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            height: fit-content;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .sidebar h3 {
            color: #2c3e50;
            margin-bottom: 1rem;
            border-bottom: 2px solid #3498db;
            padding-bottom: 0.5rem;
        }
        
        .sidebar ul {
            list-style: none;
        }
        
        .sidebar li {
            margin-bottom: 0.5rem;
        }
        
        .sidebar a {
            color: #3498db;
            text-decoration: none;
            display: block;
            padding: 0.3rem 0;
            transition: color 0.3s;
        }
        
        .sidebar a:hover {
            color: #2980b9;
            text-decoration: underline;
        }
        
        /* Main content */
        .main-content {
            background: white;
            border-radius: 8px;
            padding: 2rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .content h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 1rem;
            margin-bottom: 2rem;
        }
        
        .content h2 {
            color: #34495e;
            margin-top: 2rem;
            margin-bottom: 1rem;
            border-left: 4px solid #3498db;
            padding-left: 1rem;
        }
        
        .content h3 {
            color: #34495e;
            margin-top: 1.5rem;
            margin-bottom: 0.5rem;
        }
        
        .content p {
            margin-bottom: 1rem;
        }
        
        .content ul, .content ol {
            margin-left: 2rem;
            margin-bottom: 1rem;
        }
        
        /* Wiki links */
        .wiki-link {
            color: #3498db;
            text-decoration: none;
            padding: 2px 4px;
            border-radius: 3px;
            transition: all 0.3s;
        }
        
        .wiki-link:hover {
            background: #3498db;
            color: white;
        }
        
        /* Images */
        .content img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 1rem 0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        /* Image gallery */
        .image-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }
        
        .image-item {
            text-align: center;
        }
        
        .image-item img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .image-item img:hover {
            transform: scale(1.05);
        }
        
        .image-item a {
            color: #3498db;
            text-decoration: none;
            font-size: 0.9rem;
        }
        
        /* Navigation footer */
        .nav-footer {
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 2px solid #ecf0f1;
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .nav-section {
            flex: 1;
            min-width: 200px;
        }
        
        .nav-section h4 {
            color: #2c3e50;
            margin-bottom: 0.5rem;
        }
        
        .nav-section ul {
            list-style: none;
            margin: 0;
        }
        
        .nav-section li {
            margin-bottom: 0.3rem;
        }
        
        /* Search box */
        .search-box {
            margin-bottom: 2rem;
        }
        
        .search-input {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid #bdc3c7;
            border-radius: 4px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #3498db;
        }
        
        /* Breadcrumbs */
        .breadcrumbs {
            background: #ecf0f1;
            padding: 1rem 0;
            margin-bottom: 2rem;
        }
        
        .breadcrumbs-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }
        
        .breadcrumbs a {
            color: #3498db;
            text-decoration: none;
        }
        
        .breadcrumbs a:hover {
            text-decoration: underline;
        }
        
        /* Responsive design */
        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
                padding: 1rem;
            }
            
            .header-content {
                flex-direction: column;
                gap: 1rem;
            }
            
            .nav-buttons {
                flex-wrap: wrap;
                justify-content: center;
            }
        }
        
        /* Print styles */
        @media print {
            .header, .sidebar, .nav-footer {
                display: none;
            }
            
            .container {
                grid-template-columns: 1fr;
                max-width: none;
            }
            
            .main-content {
                box-shadow: none;
                margin: 0;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <h1>Gladys Klingenberg's Life Story Wiki</h1>
            <nav class="nav-buttons">
                <a href="index.html" class="nav-button">ğŸ  Home</a>
                <a href="people.html" class="nav-button">ğŸ‘¥ People</a>
                <a href="places.html" class="nav-button">ğŸ“ Places</a>
                <a href="images.html" class="nav-button">ğŸ–¼ï¸ Images</a>
                <a href="graph.html" class="nav-button">ğŸ•¸ï¸ Graph</a>
            </nav>
        </div>
    </header>
    
    <div class="breadcrumbs">
        <div class="breadcrumbs-content">
            <a href="index.html">Home</a>
        </div>
    </div>
    
    <div class="container">
        <aside class="sidebar">
            <div class="search-box">
                <input type="text" class="search-input" placeholder="Search wiki..." onkeyup="searchWiki(this.value)">
            </div>
            
            <h3>Quick Navigation</h3>
            <ul>
                <li><a href="index.html">ğŸ  Wiki Home</a></li>
                <li><a href="people.html">ğŸ‘¥ All People (16)</a></li>
                <li><a href="places.html">ğŸ“ All Places (17)</a></li>
                <li><a href="images.html">ğŸ–¼ï¸ All Images (306)</a></li>
                <li><a href="graph.html">ğŸ•¸ï¸ Relationship Graph</a></li>
            </ul>
            
            <h3>Key People</h3>
            <ul>
                <li><a href="people/gladys_klingenberg.html">Gladys Klingenberg</a></li>
                <li><a href="people/tom_herrman.html">Tom Herrman</a></li>
                <li><a href="people/bryant_herrman.html">Bryant Herrman</a></li>
                <li><a href="people/mary_safrona.html">Mary Safrona</a></li>
            </ul>
            
            <h3>Notable Places</h3>
            <ul>
                <li><a href="places/family_farm.html">Family Farm</a></li>
                <li><a href="places/lutheran_church.html">Lutheran Church</a></li>
                <li><a href="places/minnesota.html">Minnesota</a></li>
                <li><a href="places/chicago.html">Chicago</a></li>
            </ul>
        </aside>
        
        <main class="main-content">
            <div class="content">
                <h1>Gladys Folder - Code Dependencies Analysis</h1>
<p><em>Detailed analysis of Python scripts, their dependencies, and refactoring opportunities</em></p>
<hr />
<h2>ğŸ“œ Script Inventory</h2>
<h3>1. create_pdf_wiki.py</h3>
<p><strong>Purpose:</strong> Main PDF processing and wiki generation<br />
<strong>Lines:</strong> 623<br />
<strong>Last Modified:</strong> Recent (based on content)<br />
<strong>Status:</strong> âœ… Functional</p>
<h3>2. ocr_entity_extraction.py</h3>
<p><strong>Purpose:</strong> OCR-based entity extraction from PDF<br />
<strong>Lines:</strong> 249<br />
<strong>Last Modified:</strong> Recent<br />
<strong>Status:</strong> âœ… Functional</p>
<h3>3. update_wiki_with_all_people.py</h3>
<p><strong>Purpose:</strong> Update wiki with comprehensive people list<br />
<strong>Lines:</strong> 328<br />
<strong>Last Modified:</strong> Recent<br />
<strong>Status:</strong> âœ… Functional</p>
<hr />
<h2>ğŸ”— Dependency Graph</h2>
<pre><code>External Libraries:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PyMuPDF (fitz)                             â”‚
â”‚    â”œâ”€â–º create_pdf_wiki.py                   â”‚
â”‚    â””â”€â–º ocr_entity_extraction.py             â”‚
â”‚                                              â”‚
â”‚  pytesseract (optional)                     â”‚
â”‚    â””â”€â–º ocr_entity_extraction.py             â”‚
â”‚                                              â”‚
â”‚  easyocr (optional)                         â”‚
â”‚    â””â”€â–º ocr_entity_extraction.py             â”‚
â”‚                                              â”‚
â”‚  PIL (Pillow)                               â”‚
â”‚    â””â”€â–º ocr_entity_extraction.py             â”‚
â”‚                                              â”‚
â”‚  Standard Library:                          â”‚
â”‚    â”œâ”€â–º re (all scripts)                     â”‚
â”‚    â”œâ”€â–º pathlib (all scripts)                â”‚
â”‚    â”œâ”€â–º collections (create_pdf_wiki.py)     â”‚
â”‚    â”œâ”€â–º io (ocr_entity_extraction.py)        â”‚
â”‚    â””â”€â–º os (all scripts)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Script Dependencies:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  create_pdf_wiki.py                         â”‚
â”‚    â”œâ”€ Reads: PDF                            â”‚
â”‚    â”œâ”€ Writes: All wiki files                â”‚
â”‚    â””â”€ Independent (no script deps)          â”‚
â”‚                                              â”‚
â”‚  ocr_entity_extraction.py                   â”‚
â”‚    â”œâ”€ Reads: PDF                            â”‚
â”‚    â”œâ”€ Writes: Console output                â”‚
â”‚    â””â”€ Independent (analysis only)           â”‚
â”‚                                              â”‚
â”‚  update_wiki_with_all_people.py             â”‚
â”‚    â”œâ”€ Reads: Existing wiki                  â”‚
â”‚    â”œâ”€ Writes: Updates to wiki               â”‚
â”‚    â””â”€ Requires: create_pdf_wiki.py output   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr />
<h2>ğŸ“¦ Function Analysis</h2>
<h3>create_pdf_wiki.py Functions</h3>
<pre><code class="language-python">extract_pdf_content(pdf_path)
â”œâ”€ Purpose: Extract text and images from PDF
â”œâ”€ Input: Path to PDF file
â”œâ”€ Output: (pages dict, images_info list)
â”œâ”€ Dependencies: fitz (PyMuPDF)
â”œâ”€ Calls: clean_text_content()
â””â”€ Used by: main()

clean_text_content(text)
â”œâ”€ Purpose: Clean and normalize extracted text
â”œâ”€ Input: Raw text string
â”œâ”€ Output: Cleaned text string
â”œâ”€ Dependencies: re
â””â”€ Used by: extract_pdf_content()

identify_key_entities(pages)
â”œâ”€ Purpose: Identify people, places, themes
â”œâ”€ Input: Pages dictionary
â”œâ”€ Output: (people set, places set, themes dict)
â”œâ”€ Dependencies: re, collections
â”œâ”€ Calls: filter_entities(), identify_memoir_themes()
â””â”€ Used by: main()

filter_entities(entities, stopwords)
â”œâ”€ Purpose: Remove false positives
â”œâ”€ Input: Entity set, stopwords list
â”œâ”€ Output: Filtered list
â””â”€ Used by: identify_key_entities()

identify_memoir_themes(text)
â”œâ”€ Purpose: Detect memoir themes
â”œâ”€ Input: Combined text
â”œâ”€ Output: Themes dictionary
â””â”€ Used by: identify_key_entities()

create_entity_pages(pages, people, places, themes, images_info, wiki_root)
â”œâ”€ Purpose: Create all entity pages
â”œâ”€ Input: All extracted data
â”œâ”€ Output: None (writes files)
â”œâ”€ Calls: create_person_page(), create_place_page(), create_theme_page()
â””â”€ Used by: main()

create_person_page(person, pages, images_info, people_dir)
â”œâ”€ Purpose: Create individual person page
â”œâ”€ Input: Person name, pages, images, directory
â”œâ”€ Output: None (writes file)
â”œâ”€ Calls: find_entity_references(), find_related_images()
â””â”€ Used by: create_entity_pages()

create_place_page(place, pages, images_info, places_dir)
â”œâ”€ Purpose: Create individual place page
â”œâ”€ Input: Place name, pages, images, directory
â”œâ”€ Output: None (writes file)
â”œâ”€ Calls: find_entity_references(), find_related_images()
â””â”€ Used by: create_entity_pages()

create_theme_page(theme, count, pages, images_info, themes_dir)
â”œâ”€ Purpose: Create individual theme page
â”œâ”€ Input: Theme name, count, pages, images, directory
â”œâ”€ Output: None (writes file)
â”œâ”€ Calls: get_theme_description()
â””â”€ Used by: create_entity_pages()

get_theme_description(theme)
â”œâ”€ Purpose: Get description for theme
â”œâ”€ Input: Theme name
â”œâ”€ Output: Description string
â””â”€ Used by: create_theme_page()

find_entity_references(entity, pages)
â”œâ”€ Purpose: Find all page references for entity
â”œâ”€ Input: Entity name, pages dictionary
â”œâ”€ Output: List of (page_num, context) tuples
â””â”€ Used by: create_person_page(), create_place_page()

find_related_images(entity, images_info)
â”œâ”€ Purpose: Find images related to entity
â”œâ”€ Input: Entity name, images list
â”œâ”€ Output: List of related image dicts
â””â”€ Used by: create_person_page(), create_place_page()

create_images_pages(images_info, wiki_root)
â”œâ”€ Purpose: Create pages for all images
â”œâ”€ Input: Images list, wiki root path
â”œâ”€ Output: None (writes files)
â””â”€ Used by: main()

create_main_index(pages, people, places, themes, wiki_root)
â”œâ”€ Purpose: Create Gladys_Life_Index.md
â”œâ”€ Input: All data
â”œâ”€ Output: None (writes file)
â”œâ”€ Calls: find_entity_references()
â””â”€ Used by: main()

create_wiki_home(wiki_root, people, places, themes, images_count)
â”œâ”€ Purpose: Create s_letter/README.md
â”œâ”€ Input: Data and counts
â”œâ”€ Output: None (writes file)
â””â”€ Used by: main()

create_index_pages(wiki_root, people, places, themes, images_info)
â”œâ”€ Purpose: Create category index pages
â”œâ”€ Input: All data
â”œâ”€ Output: None (writes files)
â””â”€ Used by: main()

main()
â”œâ”€ Purpose: Orchestrate wiki generation
â”œâ”€ Input: None (uses hardcoded paths)
â”œâ”€ Output: Exit code
â””â”€ Calls: Most functions above
</code></pre>
<h3>ocr_entity_extraction.py Functions</h3>
<pre><code class="language-python">extract_text_with_ocr(pdf_path, max_pages=50)
â”œâ”€ Purpose: Extract text using OCR
â”œâ”€ Input: PDF path, max pages to process
â”œâ”€ Output: Dictionary of page texts
â”œâ”€ Dependencies: fitz, pytesseract or easyocr, PIL
â””â”€ Used by: __main__

find_people_in_ocr_text(page_texts)
â”œâ”€ Purpose: Find people names in OCR text
â”œâ”€ Input: OCR text dictionary
â”œâ”€ Output: Dictionary of people and page numbers
â”œâ”€ Dependencies: re
â””â”€ Used by: __main__

create_manual_people_entries()
â”œâ”€ Purpose: Manually add expected people
â”œâ”€ Input: None
â”œâ”€ Output: Dictionary of people
â””â”€ Used by: __main__
</code></pre>
<h3>update_wiki_with_all_people.py Functions</h3>
<pre><code class="language-python">update_wiki_with_comprehensive_people()
â”œâ”€ Purpose: Main update function
â”œâ”€ Input: None (uses hardcoded data)
â”œâ”€ Output: None (updates files)
â”œâ”€ Calls: create_person_description(), get_relationships()
â”‚         update_main_index(), update_readme(), create_people_index()
â””â”€ Used by: __main__

create_person_description(person)
â”œâ”€ Purpose: Generate description for person
â”œâ”€ Input: Person name
â”œâ”€ Output: Description string
â””â”€ Used by: update_wiki_with_comprehensive_people()

get_relationships(person)
â”œâ”€ Purpose: Get known relationships
â”œâ”€ Input: Person name
â”œâ”€ Output: List of related people
â””â”€ Used by: update_wiki_with_comprehensive_people()

update_main_index(people_data, base_dir)
â”œâ”€ Purpose: Update Gladys_Life_Index.md
â”œâ”€ Input: People data, base directory
â”œâ”€ Output: None (writes file)
â””â”€ Used by: update_wiki_with_comprehensive_people()

update_readme(people_data, wiki_dir)
â”œâ”€ Purpose: Update s_letter/README.md
â”œâ”€ Input: People data, wiki directory
â”œâ”€ Output: None (writes file)
â””â”€ Used by: update_wiki_with_comprehensive_people()

create_people_index(people_data, wiki_dir)
â”œâ”€ Purpose: Update s_letter/index/people.md
â”œâ”€ Input: People data, wiki directory
â”œâ”€ Output: None (writes file)
â””â”€ Used by: update_wiki_with_comprehensive_people()

safe_filename(name)
â”œâ”€ Purpose: Convert name to safe filename
â”œâ”€ Input: Name string
â”œâ”€ Output: Safe filename string
â”œâ”€ Dependencies: re
â””â”€ Used by: Multiple functions
</code></pre>
<hr />
<h2>ğŸ”„ Code Duplication Analysis</h2>
<h3>High Duplication (&gt;80% similar)</h3>
<h4>1. safe_filename() function</h4>
<p><strong>Found in:</strong>
- <code>update_wiki_with_all_people.py</code> (lines 38-40)
- <code>update_wiki_with_all_people.py</code> (lines 181-182, 208-209, 286-287)</p>
<p><strong>Recommendation:</strong></p>
<pre><code class="language-python"># Extract to shared utilities module
# utils/filename_utils.py
def safe_filename(name):
    &quot;&quot;&quot;Convert name to safe filename&quot;&quot;&quot;
    return re.sub(r'[^\w\-_\.]', '_', name.lower().replace(' ', '_'))
</code></pre>
<h4>2. Person page creation</h4>
<p><strong>Found in:</strong>
- <code>create_pdf_wiki.py</code>: <code>create_person_page()</code>
- <code>update_wiki_with_all_people.py</code>: inline in main function</p>
<p><strong>Similarity:</strong> ~85%<br />
<strong>Recommendation:</strong> Consolidate into single function with parameters</p>
<h4>3. Index update functions</h4>
<p><strong>Found in:</strong>
- <code>create_pdf_wiki.py</code>: <code>create_main_index()</code>
- <code>update_wiki_with_all_people.py</code>: <code>update_main_index()</code></p>
<p><strong>Similarity:</strong> ~90%<br />
<strong>Recommendation:</strong> Create <code>IndexUpdater</code> class</p>
<h3>Medium Duplication (50-80% similar)</h3>
<h4>4. Entity reference finding</h4>
<p><strong>Found in:</strong>
- <code>create_pdf_wiki.py</code>: <code>find_entity_references()</code>
- Similar logic in both person and place page creation</p>
<p><strong>Similarity:</strong> ~70%<br />
<strong>Recommendation:</strong> Enhance to be more generic</p>
<h4>5. Navigation footer generation</h4>
<p><strong>Found in:</strong>
- Every page creation function
- Pattern repeated across scripts</p>
<p><strong>Similarity:</strong> ~95%<br />
<strong>Recommendation:</strong></p>
<pre><code class="language-python">def create_navigation_footer(page_type, index_page):
    &quot;&quot;&quot;Generate standard navigation footer&quot;&quot;&quot;
    return f&quot;&quot;&quot;---

**Navigation:**
- <a href="readme.html" class="wiki-link">Wiki Home</a>
- <a href="index_index_page.html" class="wiki-link">{page_type} Index</a>
- <a href="gladys_life_index.html" class="wiki-link">Main Index</a>&quot;&quot;&quot;
</code></pre>
<hr />
<h2>ğŸ—ï¸ Refactoring Opportunities</h2>
<h3>Priority 1: Critical Improvements</h3>
<h4>A. Extract Common Wiki Generator Module</h4>
<p><strong>Problem:</strong> Duplicate code across multiple scripts<br />
<strong>Solution:</strong> Create <code>wiki_generator.py</code></p>
<pre><code class="language-python"># wiki_generator.py (proposed)

class WikiGenerator:
    def __init__(self, source_type='pdf', wiki_root=None):
        self.source_type = source_type
        self.wiki_root = wiki_root

    def create_person_page(self, person, data):
        &quot;&quot;&quot;Generic person page creation&quot;&quot;&quot;
        pass

    def create_place_page(self, place, data):
        &quot;&quot;&quot;Generic place page creation&quot;&quot;&quot;
        pass

    def create_theme_page(self, theme, data):
        &quot;&quot;&quot;Generic theme page creation&quot;&quot;&quot;
        pass

    def update_index(self, index_type, data):
        &quot;&quot;&quot;Update any index file&quot;&quot;&quot;
        pass

    @staticmethod
    def safe_filename(name):
        &quot;&quot;&quot;Convert name to safe filename&quot;&quot;&quot;
        return re.sub(r'[^\w\-_\.]', '_', name.lower().replace(' ', '_'))

    @staticmethod
    def create_navigation(page_type, index_page):
        &quot;&quot;&quot;Generate navigation footer&quot;&quot;&quot;
        pass
</code></pre>
<p><strong>Benefits:</strong>
- Eliminates ~200 lines of duplicate code
- Single source of truth for wiki generation
- Easier to maintain and test</p>
<h4>B. Configuration System</h4>
<p><strong>Problem:</strong> Hardcoded paths throughout scripts<br />
<strong>Solution:</strong> Create <code>config.py</code> or <code>config.yaml</code></p>
<pre><code class="language-python"># config.py (proposed)

from pathlib import Path

class Config:
    BASE_DIR = Path(&quot;E:/dynamic-indexer/Gladys&quot;)
    PDF_PATH = BASE_DIR / &quot;MyLifeStoryGladys Klingenberg.pdf&quot;
    WIKI_ROOT = BASE_DIR / &quot;s_letter&quot;  # TODO: Rename to &quot;wiki&quot;
    IMAGES_DIR = BASE_DIR / &quot;images&quot;
    MAIN_INDEX = BASE_DIR / &quot;Gladys_Life_Index.md&quot;

    # OCR settings
    OCR_MAX_PAGES = 50
    OCR_CONFIDENCE_THRESHOLD = 0.5

    # Entity extraction settings
    PEOPLE_PATTERNS = [
        r'\b[A-Z][a-z]+ [A-Z][a-z]+\b',
        r'\b(?:Mr\.|Mrs\.|Ms\.|Dr\.)\s+[A-Z][a-z]+\b',
    ]
</code></pre>
<p><strong>Benefits:</strong>
- Single place for configuration
- Easy to adapt for other projects
- No code changes for path updates</p>
<h4>C. Entity Extraction Pipeline</h4>
<p><strong>Problem:</strong> Entity extraction logic scattered across files<br />
<strong>Solution:</strong> Create <code>entity_extractor.py</code></p>
<pre><code class="language-python"># entity_extractor.py (proposed)

class EntityExtractor:
    def __init__(self, text_source):
        self.text_source = text_source
        self.people = []
        self.places = []
        self.themes = []

    def extract_all(self):
        &quot;&quot;&quot;Run all extraction methods&quot;&quot;&quot;
        self.extract_people()
        self.extract_places()
        self.extract_themes()
        return self

    def extract_people(self):
        &quot;&quot;&quot;Extract people using multiple strategies&quot;&quot;&quot;
        pass

    def extract_places(self):
        &quot;&quot;&quot;Extract places using NLP&quot;&quot;&quot;
        pass

    def extract_themes(self):
        &quot;&quot;&quot;Extract themes using keyword analysis&quot;&quot;&quot;
        pass
</code></pre>
<p><strong>Benefits:</strong>
- Modular extraction pipeline
- Easier to add new extraction methods
- Better testing coverage</p>
<h3>Priority 2: Important Enhancements</h3>
<h4>D. Add Error Handling</h4>
<p><strong>Current Issues:</strong>
- No try-except blocks in critical sections
- File operations can fail silently
- No logging</p>
<p><strong>Proposed:</strong></p>
<pre><code class="language-python">import logging

logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    handlers=[
        logging.FileHandler('wiki_generation.log'),
        logging.StreamHandler()
    ]
)

def create_person_page(person, data):
    try:
        # ... page creation logic
        logging.info(f&quot;Created person page: {person}&quot;)
    except IOError as e:
        logging.error(f&quot;Failed to create page for {person}: {e}&quot;)
        raise
    except Exception as e:
        logging.error(f&quot;Unexpected error for {person}: {e}&quot;)
        raise
</code></pre>
<h4>E. Add Unit Tests</h4>
<p><strong>Current:</strong> No tests<br />
<strong>Proposed:</strong> Create <code>tests/</code> directory</p>
<pre><code>tests/
â”œâ”€â”€ test_wiki_generator.py
â”œâ”€â”€ test_entity_extractor.py
â”œâ”€â”€ test_filename_utils.py
â””â”€â”€ test_integration.py
</code></pre>
<p><strong>Sample:</strong></p>
<pre><code class="language-python"># tests/test_filename_utils.py
import unittest
from wiki_generator import WikiGenerator

class TestFilenameUtils(unittest.TestCase):
    def test_safe_filename_basic(self):
        self.assertEqual(
            WikiGenerator.safe_filename(&quot;John Doe&quot;),
            &quot;john_doe&quot;
        )

    def test_safe_filename_special_chars(self):
        self.assertEqual(
            WikiGenerator.safe_filename(&quot;Mary O'Brien&quot;),
            &quot;mary_o_brien&quot;
        )
</code></pre>
<h4>F. Command-Line Interface</h4>
<p><strong>Current:</strong> Scripts run with hardcoded values<br />
<strong>Proposed:</strong> Add CLI with argparse</p>
<pre><code class="language-python"># wiki_cli.py (proposed)

import argparse

def main():
    parser = argparse.ArgumentParser(
        description=&quot;Generate wiki from Gladys memoir PDF&quot;
    )
    parser.add_argument(
        'pdf_path',
        help='Path to source PDF'
    )
    parser.add_argument(
        '--wiki-root',
        default='s_letter',
        help='Wiki root directory name'
    )
    parser.add_argument(
        '--ocr',
        action='store_true',
        help='Use OCR for text extraction'
    )
    parser.add_argument(
        '--max-pages',
        type=int,
        default=50,
        help='Maximum pages to process with OCR'
    )

    args = parser.parse_args()

    # Run wiki generation with arguments
    generate_wiki(args)
</code></pre>
<h3>Priority 3: Nice-to-Have</h3>
<h4>G. Progress Tracking</h4>
<pre><code class="language-python">from tqdm import tqdm

def create_all_pages(items):
    for item in tqdm(items, desc=&quot;Creating pages&quot;):
        create_page(item)
</code></pre>
<h4>H. Caching</h4>
<pre><code class="language-python">import json
from functools import lru_cache

@lru_cache(maxsize=128)
def extract_page_content(page_num):
    &quot;&quot;&quot;Cache extracted page content&quot;&quot;&quot;
    pass

def save_cache():
    &quot;&quot;&quot;Save extraction cache to disk&quot;&quot;&quot;
    cache_file = 'extraction_cache.json'
    with open(cache_file, 'w') as f:
        json.dump(cache_data, f)
</code></pre>
<hr />
<h2>ğŸ”¬ Code Quality Metrics</h2>
<pre><code>Script Complexity Analysis:

create_pdf_wiki.py:
â”œâ”€ Lines: 623
â”œâ”€ Functions: 14
â”œâ”€ Avg function length: 44 lines (MEDIUM)
â”œâ”€ Cyclomatic complexity: Medium
â”œâ”€ Maintainability: Fair
â””â”€ Test coverage: 0% âš ï¸

ocr_entity_extraction.py:
â”œâ”€ Lines: 249
â”œâ”€ Functions: 3
â”œâ”€ Avg function length: 83 lines (HIGH âš ï¸)
â”œâ”€ Cyclomatic complexity: Medium
â”œâ”€ Maintainability: Fair
â””â”€ Test coverage: 0% âš ï¸

update_wiki_with_all_people.py:
â”œâ”€ Lines: 328
â”œâ”€ Functions: 7
â”œâ”€ Avg function length: 47 lines (MEDIUM)
â”œâ”€ Cyclomatic complexity: Low
â”œâ”€ Maintainability: Good
â””â”€ Test coverage: 0% âš ï¸
</code></pre>
<hr />
<h2>ğŸ“Š Technical Debt Analysis</h2>
<table>
<thead>
<tr>
<th>Issue</th>
<th>Severity</th>
<th>Effort</th>
<th>Priority</th>
</tr>
</thead>
<tbody>
<tr>
<td>Code duplication</td>
<td>HIGH</td>
<td>Medium</td>
<td>1</td>
</tr>
<tr>
<td>No error handling</td>
<td>HIGH</td>
<td>Low</td>
<td>1</td>
</tr>
<tr>
<td>Hardcoded paths</td>
<td>MEDIUM</td>
<td>Low</td>
<td>1</td>
</tr>
<tr>
<td>No tests</td>
<td>HIGH</td>
<td>High</td>
<td>2</td>
</tr>
<tr>
<td>No logging</td>
<td>MEDIUM</td>
<td>Low</td>
<td>2</td>
</tr>
<tr>
<td>No CLI</td>
<td>LOW</td>
<td>Medium</td>
<td>3</td>
</tr>
<tr>
<td>Large functions</td>
<td>MEDIUM</td>
<td>Medium</td>
<td>2</td>
</tr>
<tr>
<td>No documentation</td>
<td>LOW</td>
<td>Medium</td>
<td>3</td>
</tr>
</tbody>
</table>
<hr />
<h2>ğŸ› ï¸ Refactoring Roadmap</h2>
<h3>Phase 1: Foundation (Week 1)</h3>
<ul>
<li>[ ] Extract <code>wiki_generator.py</code> module</li>
<li>[ ] Create <code>config.py</code> for configuration</li>
<li>[ ] Add error handling to critical paths</li>
<li>[ ] Set up logging</li>
</ul>
<h3>Phase 2: Consolidation (Week 2)</h3>
<ul>
<li>[ ] Refactor <code>create_pdf_wiki.py</code> to use shared module</li>
<li>[ ] Refactor <code>update_wiki_with_all_people.py</code> to use shared module</li>
<li>[ ] Create <code>entity_extractor.py</code> module</li>
<li>[ ] Add unit tests for shared modules</li>
</ul>
<h3>Phase 3: Enhancement (Week 3)</h3>
<ul>
<li>[ ] Add CLI interface</li>
<li>[ ] Implement caching</li>
<li>[ ] Add progress tracking</li>
<li>[ ] Write integration tests</li>
</ul>
<h3>Phase 4: Documentation (Week 4)</h3>
<ul>
<li>[ ] Add function docstrings</li>
<li>[ ] Create API documentation</li>
<li>[ ] Write user guide</li>
<li>[ ] Add code examples</li>
</ul>
<hr />
<h2>ğŸ“ Import Statement Analysis</h2>
<h3>create_pdf_wiki.py</h3>
<pre><code class="language-python">import re                    # Standard library âœ“
import os                    # Standard library âœ“
from pathlib import Path     # Standard library âœ“
import sys                   # Standard library âœ“
from collections import defaultdict, Counter  # Standard library âœ“
import json                  # Standard library âœ“
import fitz                  # External: PyMuPDF âš ï¸ (check version)
</code></pre>
<h3>ocr_entity_extraction.py</h3>
<pre><code class="language-python">import fitz                  # External: PyMuPDF âš ï¸
import re                    # Standard library âœ“
import os                    # Standard library âœ“
from pathlib import Path     # Standard library âœ“
from PIL import Image        # External: Pillow âš ï¸
import io                    # Standard library âœ“
import pytesseract           # External: Optional âš ï¸
import easyocr               # External: Optional âš ï¸
</code></pre>
<h3>update_wiki_with_all_people.py</h3>
<pre><code class="language-python">import re                    # Standard library âœ“
import os                    # Standard library âœ“
from pathlib import Path     # Standard library âœ“
</code></pre>
<p><strong>Recommendation:</strong> Create <code>requirements.txt</code>:</p>
<pre><code>PyMuPDF&gt;=1.23.0
Pillow&gt;=10.0.0
pytesseract&gt;=0.3.10  # optional
easyocr&gt;=1.7.0       # optional
</code></pre>
<hr />
<h2>ğŸ¯ Best Practices Checklist</h2>
<h3>Current State</h3>
<ul>
<li>[ ] DRY (Don't Repeat Yourself)</li>
<li>[ ] SOLID principles</li>
<li>[ ] Error handling</li>
<li>[x] Meaningful variable names</li>
<li>[ ] Function documentation</li>
<li>[ ] Unit tests</li>
<li>[ ] Integration tests</li>
<li>[ ] Configuration management</li>
<li>[x] Consistent code style</li>
<li>[ ] Logging</li>
<li>[ ] Type hints</li>
<li>[ ] CLI interface</li>
</ul>
<h3>Target State (After Refactoring)</h3>
<ul>
<li>[x] DRY (Don't Repeat Yourself)</li>
<li>[x] SOLID principles</li>
<li>[x] Error handling</li>
<li>[x] Meaningful variable names</li>
<li>[x] Function documentation</li>
<li>[x] Unit tests</li>
<li>[x] Integration tests</li>
<li>[x] Configuration management</li>
<li>[x] Consistent code style</li>
<li>[x] Logging</li>
<li>[x] Type hints</li>
<li>[x] CLI interface</li>
</ul>
<hr />
<p><em>This dependency analysis provides the technical foundation for refactoring the Gladys wiki generation codebase.</em></p>
<p><strong>Last Updated:</strong> October 14, 2025</p>
            </div>
            
            <footer class="nav-footer">
                <div class="nav-section">
                    <h4>Navigation</h4>
                    <ul>
                        <li><a href="index.html">Wiki Home</a></li>
                        <li><a href="people.html">People Index</a></li>
                        <li><a href="places.html">Places Index</a></li>
                        <li><a href="images.html">Images Index</a></li>
                    </ul>
                </div>
                <div class="nav-section">
                    <h4>Features</h4>
                    <ul>
                        <li><a href="graph.html">Relationship Graph</a></li>
                        <li><a href="javascript:window.print()">Print This Page</a></li>
                        <li><a href="#" onclick="toggleDarkMode()">Toggle Dark Mode</a></li>
                    </ul>
                </div>
                <div class="nav-section">
                    <h4>About</h4>
                    <p>Generated from Gladys Klingenberg's memoir with 350+ pages, 16 people, 17 places, and 306 images.</p>
                </div>
            </footer>
        </main>
    </div>
    
    <script>
        // Search functionality
        function searchWiki(query) {
            if (query.length < 2) return;
            
            // Simple client-side search implementation
            const content = document.querySelector('.content');
            const text = content.textContent.toLowerCase();
            const queryLower = query.toLowerCase();
            
            // Highlight search terms (basic implementation)
            if (text.includes(queryLower)) {
                console.log('Search found results for:', query);
                // In a full implementation, this would highlight results
            }
        }
        
        // Dark mode toggle
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
        }
        
        // Handle wiki links
        document.addEventListener('DOMContentLoaded', function() {
            // Convert [[wiki links]] to actual links
            const content = document.querySelector('.content');
            if (content) {
                let html = content.innerHTML;
                // Convert [[link]] to <a href="link.html" class="wiki-link">link</a>
                html = html.replace(/\[\[([^\]]+)\]\]/g, function(match, link) {
                    const parts = link.split('|');
                    const target = parts[0].trim();
                    const display = parts[1] ? parts[1].trim() : target;
                    
                    // Convert target to filename
                    let filename = target.replace(/[^a-zA-Z0-9_-]/g, '_').toLowerCase();
                    if (filename.startsWith('../')) {
                        filename = filename.substring(3);
                    }
                    if (!filename.endsWith('.html')) {
                        filename += '.html';
                    }
                    
                    return `<a href="${filename}" class="wiki-link">${display}</a>`;
                });
                content.innerHTML = html;
            }
        });
        
        // Image lightbox
        function openLightbox(src) {
            const lightbox = document.createElement('div');
            lightbox.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
                cursor: pointer;
            `;
            
            const img = document.createElement('img');
            img.src = src;
            img.style.cssText = `
                max-width: 90%;
                max-height: 90%;
                object-fit: contain;
            `;
            
            lightbox.appendChild(img);
            lightbox.addEventListener('click', () => document.body.removeChild(lightbox));
            document.body.appendChild(lightbox);
        }
        
        // Add click handlers to images
        document.addEventListener('DOMContentLoaded', function() {
            const images = document.querySelectorAll('.content img, .image-gallery img');
            images.forEach(img => {
                img.addEventListener('click', () => openLightbox(img.src));
                img.style.cursor = 'pointer';
            });
        });
    </script>
</body>
</html>